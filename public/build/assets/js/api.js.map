{"version":3,"sources":["emojify.js","api.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"api.js","sourcesContent":["(function (root, factory) {\n    'use strict';\n\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], factory);\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    } else {\n        // Browser globals (root is window)\n        root.emojify = factory();\n    }\n}(this, function () {\n        'use strict';\n\n        var emojify = (function () {\n            /**\n             * NB!\n             * The namedEmojiString variable is updated automatically by the\n             * \"update\" gulp task. Do not remove the comment as this will\n             * cause the gulp task to stop working.\n             */\n            var namedEmojiString =\n            /*##EMOJILIST*/\"+1,-1,100,1234,8ball,a,ab,abc,abcd,accept,aerial_tramway,airplane,alarm_clock,alien,ambulance,anchor,angel,anger,angry,anguished,ant,apple,aquarius,aries,arrow_backward,arrow_double_down,arrow_double_up,arrow_down,arrow_down_small,arrow_forward,arrow_heading_down,arrow_heading_up,arrow_left,arrow_lower_left,arrow_lower_right,arrow_right,arrow_right_hook,arrow_up,arrow_up_down,arrow_up_small,arrow_upper_left,arrow_upper_right,arrows_clockwise,arrows_counterclockwise,art,articulated_lorry,astonished,atm,b,baby,baby_bottle,baby_chick,baby_symbol,back,baggage_claim,balloon,ballot_box_with_check,bamboo,banana,bangbang,bank,bar_chart,barber,baseball,basketball,bath,bathtub,battery,bear,bee,beer,beers,beetle,beginner,bell,bento,bicyclist,bike,bikini,bird,birthday,black_circle,black_joker,black_medium_small_square,black_medium_square,black_nib,black_small_square,black_square,black_square_button,blossom,blowfish,blue_book,blue_car,blue_heart,blush,boar,boat,bomb,book,bookmark,bookmark_tabs,books,boom,boot,bouquet,bow,bowling,bowtie,boy,bread,bride_with_veil,bridge_at_night,briefcase,broken_heart,bug,bulb,bullettrain_front,bullettrain_side,bus,busstop,bust_in_silhouette,busts_in_silhouette,cactus,cake,calendar,calling,camel,camera,cancer,candy,capital_abcd,capricorn,car,card_index,carousel_horse,cat,cat2,cd,chart,chart_with_downwards_trend,chart_with_upwards_trend,checkered_flag,cherries,cherry_blossom,chestnut,chicken,children_crossing,chocolate_bar,christmas_tree,church,cinema,circus_tent,city_sunrise,city_sunset,cl,clap,clapper,clipboard,clock1,clock10,clock1030,clock11,clock1130,clock12,clock1230,clock130,clock2,clock230,clock3,clock330,clock4,clock430,clock5,clock530,clock6,clock630,clock7,clock730,clock8,clock830,clock9,clock930,closed_book,closed_lock_with_key,closed_umbrella,cloud,clubs,cn,cocktail,coffee,cold_sweat,collision,computer,confetti_ball,confounded,confused,congratulations,construction,construction_worker,convenience_store,cookie,cool,cop,copyright,corn,couple,couple_with_heart,couplekiss,cow,cow2,credit_card,crescent_moon,crocodile,crossed_flags,crown,cry,crying_cat_face,crystal_ball,cupid,curly_loop,currency_exchange,curry,custard,customs,cyclone,dancer,dancers,dango,dart,dash,date,de,deciduous_tree,department_store,diamond_shape_with_a_dot_inside,diamonds,disappointed,disappointed_relieved,dizzy,dizzy_face,do_not_litter,dog,dog2,dollar,dolls,dolphin,donut,door,doughnut,dragon,dragon_face,dress,dromedary_camel,droplet,dvd,e-mail,ear,ear_of_rice,earth_africa,earth_americas,earth_asia,egg,eggplant,eight,eight_pointed_black_star,eight_spoked_asterisk,electric_plug,elephant,email,end,envelope,es,euro,european_castle,european_post_office,evergreen_tree,exclamation,expressionless,eyeglasses,eyes,facepunch,factory,fallen_leaf,family,fast_forward,fax,fearful,feelsgood,feet,ferris_wheel,file_folder,finnadie,fire,fire_engine,fireworks,first_quarter_moon,first_quarter_moon_with_face,fish,fish_cake,fishing_pole_and_fish,fist,five,flags,flashlight,floppy_disk,flower_playing_cards,flushed,foggy,football,fork_and_knife,fountain,four,four_leaf_clover,fr,free,fried_shrimp,fries,frog,frowning,fu,fuelpump,full_moon,full_moon_with_face,game_die,gb,gem,gemini,ghost,gift,gift_heart,girl,globe_with_meridians,goat,goberserk,godmode,golf,grapes,green_apple,green_book,green_heart,grey_exclamation,grey_question,grimacing,grin,grinning,guardsman,guitar,gun,haircut,hamburger,hammer,hamster,hand,handbag,hankey,hash,hatched_chick,hatching_chick,headphones,hear_no_evil,heart,heart_decoration,heart_eyes,heart_eyes_cat,heartbeat,heartpulse,hearts,heavy_check_mark,heavy_division_sign,heavy_dollar_sign,heavy_exclamation_mark,heavy_minus_sign,heavy_multiplication_x,heavy_plus_sign,helicopter,herb,hibiscus,high_brightness,high_heel,hocho,honey_pot,honeybee,horse,horse_racing,hospital,hotel,hotsprings,hourglass,hourglass_flowing_sand,house,house_with_garden,hurtrealbad,hushed,ice_cream,icecream,id,ideograph_advantage,imp,inbox_tray,incoming_envelope,information_desk_person,information_source,innocent,interrobang,iphone,it,izakaya_lantern,jack_o_lantern,japan,japanese_castle,japanese_goblin,japanese_ogre,jeans,joy,joy_cat,jp,key,keycap_ten,kimono,kiss,kissing,kissing_cat,kissing_closed_eyes,kissing_face,kissing_heart,kissing_smiling_eyes,koala,koko,kr,large_blue_circle,large_blue_diamond,large_orange_diamond,last_quarter_moon,last_quarter_moon_with_face,laughing,leaves,ledger,left_luggage,left_right_arrow,leftwards_arrow_with_hook,lemon,leo,leopard,libra,light_rail,link,lips,lipstick,lock,lock_with_ink_pen,lollipop,loop,loudspeaker,love_hotel,love_letter,low_brightness,m,mag,mag_right,mahjong,mailbox,mailbox_closed,mailbox_with_mail,mailbox_with_no_mail,man,man_with_gua_pi_mao,man_with_turban,mans_shoe,maple_leaf,mask,massage,meat_on_bone,mega,melon,memo,mens,metal,metro,microphone,microscope,milky_way,minibus,minidisc,mobile_phone_off,money_with_wings,moneybag,monkey,monkey_face,monorail,mortar_board,mount_fuji,mountain_bicyclist,mountain_cableway,mountain_railway,mouse,mouse2,movie_camera,moyai,muscle,mushroom,musical_keyboard,musical_note,musical_score,mute,nail_care,name_badge,neckbeard,necktie,negative_squared_cross_mark,neutral_face,new,new_moon,new_moon_with_face,newspaper,ng,nine,no_bell,no_bicycles,no_entry,no_entry_sign,no_good,no_mobile_phones,no_mouth,no_pedestrians,no_smoking,non-potable_water,nose,notebook,notebook_with_decorative_cover,notes,nut_and_bolt,o,o2,ocean,octocat,octopus,oden,office,ok,ok_hand,ok_woman,older_man,older_woman,on,oncoming_automobile,oncoming_bus,oncoming_police_car,oncoming_taxi,one,open_file_folder,open_hands,open_mouth,ophiuchus,orange_book,outbox_tray,ox,package,page_facing_up,page_with_curl,pager,palm_tree,panda_face,paperclip,parking,part_alternation_mark,partly_sunny,passport_control,paw_prints,peach,pear,pencil,pencil2,penguin,pensive,performing_arts,persevere,person_frowning,person_with_blond_hair,person_with_pouting_face,phone,pig,pig2,pig_nose,pill,pineapple,pisces,pizza,plus1,point_down,point_left,point_right,point_up,point_up_2,police_car,poodle,poop,post_office,postal_horn,postbox,potable_water,pouch,poultry_leg,pound,pouting_cat,pray,princess,punch,purple_heart,purse,pushpin,put_litter_in_its_place,question,rabbit,rabbit2,racehorse,radio,radio_button,rage,rage1,rage2,rage3,rage4,railway_car,rainbow,raised_hand,raised_hands,raising_hand,ram,ramen,rat,recycle,red_car,red_circle,registered,relaxed,relieved,repeat,repeat_one,restroom,revolving_hearts,rewind,ribbon,rice,rice_ball,rice_cracker,rice_scene,ring,rocket,roller_coaster,rooster,rose,rotating_light,round_pushpin,rowboat,ru,rugby_football,runner,running,running_shirt_with_sash,sa,sagittarius,sailboat,sake,sandal,santa,satellite,satisfied,saxophone,school,school_satchel,scissors,scorpius,scream,scream_cat,scroll,seat,secret,see_no_evil,seedling,seven,shaved_ice,sheep,shell,ship,shipit,shirt,shit,shoe,shower,signal_strength,six,six_pointed_star,ski,skull,sleeping,sleepy,slot_machine,small_blue_diamond,small_orange_diamond,small_red_triangle,small_red_triangle_down,smile,smile_cat,smiley,smiley_cat,smiling_imp,smirk,smirk_cat,smoking,snail,snake,snowboarder,snowflake,snowman,sob,soccer,soon,sos,sound,space_invader,spades,spaghetti,sparkle,sparkler,sparkles,sparkling_heart,speak_no_evil,speaker,speech_balloon,speedboat,squirrel,star,star2,stars,station,statue_of_liberty,steam_locomotive,stew,straight_ruler,strawberry,stuck_out_tongue,stuck_out_tongue_closed_eyes,stuck_out_tongue_winking_eye,sun_with_face,sunflower,sunglasses,sunny,sunrise,sunrise_over_mountains,surfer,sushi,suspect,suspension_railway,sweat,sweat_drops,sweat_smile,sweet_potato,swimmer,symbols,syringe,tada,tanabata_tree,tangerine,taurus,taxi,tea,telephone,telephone_receiver,telescope,tennis,tent,thought_balloon,three,thumbsdown,thumbsup,ticket,tiger,tiger2,tired_face,tm,toilet,tokyo_tower,tomato,tongue,top,tophat,tractor,traffic_light,train,train2,tram,triangular_flag_on_post,triangular_ruler,trident,triumph,trolleybus,trollface,trophy,tropical_drink,tropical_fish,truck,trumpet,tshirt,tulip,turtle,tv,twisted_rightwards_arrows,two,two_hearts,two_men_holding_hands,two_women_holding_hands,u5272,u5408,u55b6,u6307,u6708,u6709,u6e80,u7121,u7533,u7981,u7a7a,uk,umbrella,unamused,underage,unlock,up,us,v,vertical_traffic_light,vhs,vibration_mode,video_camera,video_game,violin,virgo,volcano,vs,walking,waning_crescent_moon,waning_gibbous_moon,warning,watch,water_buffalo,watermelon,wave,wavy_dash,waxing_crescent_moon,waxing_gibbous_moon,wc,weary,wedding,whale,whale2,wheelchair,white_check_mark,white_circle,white_flower,white_large_square,white_medium_small_square,white_medium_square,white_small_square,white_square_button,wind_chime,wine_glass,wink,wolf,woman,womans_clothes,womans_hat,womens,worried,wrench,x,yellow_heart,yen,yum,zap,zero,zzz\";\n\n            var namedEmoji = namedEmojiString.split(/,/);\n\n            /* A hash with the named emoji as keys */\n            var namedMatchHash = namedEmoji.reduce(function(memo, v) {\n                memo[v] = true;\n                return memo;\n            }, {});\n\n            var emoticonsProcessed;\n            var emojiMegaRe;\n\n            function initEmoticonsProcessed() {\n                /* List of emoticons used in the regular expression */\n                var emoticons = {\n         /* :..: */ named: /:([a-z0-9A-Z_-]+):/,\n         /* :-)  */ smile: /:-?\\)/g,\n         /* :o   */ open_mouth: /:o/gi,\n         /* :-o  */ scream: /:-o/gi,\n         /* :-]  */ smirk: /[:;]-?]/g,\n         /* :-D  */ grinning: /[:;]-?d/gi,\n         /* X-D  */ stuck_out_tongue_closed_eyes: /x-d/gi,\n         /* ;-p  */ stuck_out_tongue_winking_eye: /[:;]-?p/gi,\n   /* :-[ / :-@  */ rage: /:-?[\\[@]/g,\n         /* :-(  */ frowning: /:-?\\(/g,\n         /* :'-( */ sob: /:['’]-?\\(|:&#x27;\\(/g,\n         /* :-*  */ kissing_heart: /:-?\\*/g,\n         /* ;-)  */ wink: /;-?\\)/g,\n         /* :-/  */ pensive: /:-?\\//g,\n         /* :-s  */ confounded: /:-?s/gi,\n         /* :-|  */ flushed: /:-?\\|/g,\n         /* :-$  */ relaxed: /:-?\\$/g,\n         /* :-x  */ mask: /:-x/gi,\n         /* <3   */ heart: /<3|&lt;3/g,\n         /* </3  */ broken_heart: /<\\/3|&lt;&#x2F;3/g,\n         /* :+1: */ thumbsup: /:\\+1:/g,\n         /* :-1: */ thumbsdown: /:\\-1:/g\n                };\n\n                if (defaultConfig.ignore_emoticons) {\n                    emoticons = {\n             /* :..: */ named: /:([a-z0-9A-Z_-]+):/,\n             /* :+1: */ thumbsup: /:\\+1:/g,\n             /* :-1: */ thumbsdown: /:\\-1:/g\n                    };\n                }\n\n                return Object.keys(emoticons).map(function(key) {\n                    return [emoticons[key], key];\n                });\n            }\n\n            function initMegaRe() {\n                /* The source for our mega-regex */\n                var mega = emoticonsProcessed\n                        .map(function(v) {\n                            var re = v[0];\n                            var val = re.source || re;\n                            val = val.replace(/(^|[^\\[])\\^/g, '$1');\n                            return \"(\" + val + \")\";\n                        })\n                        .join('|');\n\n                /* The regex used to find emoji */\n                return new RegExp(mega, \"gi\");\n            }\n\n            var defaultConfig = {\n                blacklist: {\n                    'ids': [],\n                    'classes': ['no-emojify'],\n                    'elements': ['script', 'textarea', 'a', 'pre', 'code']\n                },\n                tag_type: null,\n                only_crawl_id: null,\n                img_dir: 'images/emoji',\n                ignore_emoticons: false,\n                mode: 'img'\n            };\n\n            /* Returns true if the given char is whitespace */\n            function isWhitespace(s) {\n                return s === ' ' || s === '\\t' || s === '\\r' || s === '\\n' || s === '' || s === String.fromCharCode(160);\n            }\n\n            var modeToElementTagType = {\n                'img': 'img',\n                'sprite': 'span',\n                'data-uri': 'span'\n            };\n\n            /* Given a match in a node, replace the text with an image */\n            function insertEmojicon(args) {\n                var emojiElement = null;\n\n\n                if(args.replacer){\n                    emojiElement = args.replacer.apply({\n                            config: defaultConfig\n                        },\n                        [':' + args.emojiName + ':', args.emojiName]\n                    );\n                }\n                else {\n                    var elementType = defaultConfig.tag_type || modeToElementTagType[defaultConfig.mode];\n                    emojiElement = args.win.document.createElement(elementType);\n\n                    if (elementType !== 'img') {\n                        emojiElement.setAttribute('class', 'emoji emoji-' + args.emojiName);\n                    } else {\n                        emojiElement.setAttribute('align', 'absmiddle');\n                        emojiElement.setAttribute('alt', ':' + args.emojiName + ':');\n                        emojiElement.setAttribute('class', 'emoji');\n                        emojiElement.setAttribute('src', defaultConfig.img_dir + '/' + args.emojiName + '.png');\n                    }\n\n                    emojiElement.setAttribute('title', ':' + args.emojiName + ':');\n                }\n\n                args.node.splitText(args.match.index);\n                args.node.nextSibling.nodeValue = args.node.nextSibling.nodeValue.substr(\n                    args.match[0].length,\n                    args.node.nextSibling.nodeValue.length\n                );\n                emojiElement.appendChild(args.node.splitText(args.match.index));\n                args.node.parentNode.insertBefore(emojiElement, args.node.nextSibling);\n            }\n\n            /* Given an regex match, return the name of the matching emoji */\n            function getEmojiNameForMatch(match) {\n                /* Special case for named emoji */\n                if(match[1] && match[2]) {\n                    var named = match[2];\n                    if(namedMatchHash[named]) { return named; }\n                    return;\n                }\n                for(var i = 3; i < match.length - 1; i++) {\n                    if(match[i]) {\n                        return emoticonsProcessed[i - 2][1];\n                    }\n                }\n            }\n\n            function defaultReplacer(emoji, name) {\n                /*jshint validthis: true */\n                var elementType = this.config.tag_type || modeToElementTagType[this.config.mode];\n                if (elementType !== 'img') {\n                    return \"<\" +  elementType +\" class='emoji emoji-\" + name + \"' title=':\" + name + \":'></\" + elementType+ \">\";\n                } else {\n                    return \"<img align='absmiddle' alt=':\" + name + \":' class='emoji' src='\" + this.config.img_dir + '/' + name + \".png' title=':\" + name + \":' />\";\n                }\n            }\n\n            function Validator() {\n                this.lastEmojiTerminatedAt = -1;\n            }\n\n            Validator.prototype = {\n                validate: function(match, index, input) {\n                    var self = this;\n\n                    /* Validator */\n                    var emojiName = getEmojiNameForMatch(match);\n                    if(!emojiName) { return; }\n\n                    var m = match[0];\n                    var length = m.length;\n                    // var index = match.index;\n                    // var input = match.input;\n\n                    function success() {\n                        self.lastEmojiTerminatedAt = length + index;\n                        return emojiName;\n                    }\n\n                    /* At the beginning? */\n                    if(index === 0) { return success(); }\n\n                    /* At the end? */\n                    if(input.length === m.length + index) { return success(); }\n\n                    var hasEmojiBefore = this.lastEmojiTerminatedAt === index;\n                    if (hasEmojiBefore) { return success();}\n\n                    /* Has a whitespace before? */\n                    if(isWhitespace(input.charAt(index - 1))) { return success(); }\n\n                    var hasWhitespaceAfter = isWhitespace(input.charAt(m.length + index));\n                    /* Has a whitespace after? */\n                    if(hasWhitespaceAfter && hasEmojiBefore) { return success(); }\n\n                    return;\n                }\n            };\n\n            function emojifyString (htmlString, replacer) {\n                if(!htmlString) { return htmlString; }\n                if(!replacer) { replacer = defaultReplacer; }\n\n                emoticonsProcessed = initEmoticonsProcessed();\n                emojiMegaRe = initMegaRe();\n\n                var validator = new Validator();\n\n                return htmlString.replace(emojiMegaRe, function() {\n                    var matches = Array.prototype.slice.call(arguments, 0, -2);\n                    var index = arguments[arguments.length - 2];\n                    var input = arguments[arguments.length - 1];\n                    var emojiName = validator.validate(matches, index, input);\n                    if(emojiName) {\n                        return replacer.apply({\n                                config: defaultConfig\n                            },\n                            [arguments[0], emojiName]\n                        );\n                    }\n                    /* Did not validate, return the original value */\n                    return arguments[0];\n                });\n\n            }\n            function run(el, replacer) {\n\n                // Check if an element was not passed.\n                // This will only work in the browser\n                if(typeof el === 'undefined'){\n                    // Check if an element was configured. If not, default to the body.\n                    if (defaultConfig.only_crawl_id) {\n                        el = document.getElementById(defaultConfig.only_crawl_id);\n                    } else {\n                        el = document.body;\n                    }\n                }\n\n                // Get the window object from the passed element.\n                var doc = el.ownerDocument,\n                    win = doc.defaultView || doc.parentWindow;\n\n                var treeTraverse = function (parent, cb){\n                    var child;\n\n                    if (parent.hasChildNodes()) {\n                        child = parent.firstChild;\n                        while(child){\n                            if(cb(child)) {\n                                treeTraverse(child, cb);\n                            }\n                            child = child.nextSibling;\n                        }\n                    }\n                };\n\n                var matchAndInsertEmoji = function(node) {\n                    var match;\n                    var matches = [];\n                    var validator = new Validator();\n\n                    while ((match = emojiMegaRe.exec(node.data)) !== null) {\n                        if(validator.validate(match, match.index, match.input)) {\n                            matches.push(match);\n                        }\n                    }\n\n                    for (var i = matches.length; i-- > 0;) {\n                        /* Replace the text with the emoji */\n                        var emojiName = getEmojiNameForMatch(matches[i]);\n                        insertEmojicon({\n                            node: node,\n                            match: matches[i],\n                            emojiName: emojiName,\n                            replacer: replacer,\n                            win: win\n                        });\n                    }\n                };\n\n                emoticonsProcessed = initEmoticonsProcessed();\n                emojiMegaRe = initMegaRe();\n\n                var nodes = [];\n\n                var elementsBlacklist = new RegExp(defaultConfig.blacklist.elements.join('|'), 'i'),\n                    classesBlacklist = new RegExp(defaultConfig.blacklist.classes.join('|'), 'i');\n\n                if(typeof win.document.createTreeWalker !== 'undefined') {\n                    var nodeIterator = win.document.createTreeWalker(\n                        el,\n                        win.NodeFilter.SHOW_TEXT | win.NodeFilter.SHOW_ELEMENT,\n                        function(node) {\n                            if(node.nodeType !== 1) {\n                                /* Text Node? Good! */\n                                return win.NodeFilter.FILTER_ACCEPT;\n                            }\n\n                            if(node.tagName.match(elementsBlacklist) || node.tagName === \"svg\" || node.className.match(classesBlacklist)) {\n                                return win.NodeFilter.FILTER_REJECT;\n                            }\n\n                            return win.NodeFilter.FILTER_SKIP;\n                        },\n                        false\n                    );\n\n                    var node;\n\n                    while((node = nodeIterator.nextNode()) !== null) {\n                        nodes.push(node);\n                    }\n                }\n                else {\n                    treeTraverse(el, function(node){\n                        if(\n                            (typeof node.tagName !== 'undefined' && node.tagName.match(elementsBlacklist)) ||\n                            (typeof node.className !== 'undefined' && node.className.match(classesBlacklist))\n                        ){\n                            return false;\n                        }\n                        if (node.nodeType === 1) {\n                            return true;\n                        }\n\n                        nodes.push(node);\n                        return true;\n                    });\n                }\n\n                nodes.forEach(matchAndInsertEmoji);\n            }\n\n            return {\n                // Sane defaults\n                defaultConfig: defaultConfig,\n                emojiNames: namedEmoji,\n                setConfig: function (newConfig) {\n                    Object.keys(defaultConfig).forEach(function(f) {\n                        if(f in newConfig) {\n                            defaultConfig[f] = newConfig[f];\n                        }\n                    });\n                },\n\n                replace: emojifyString,\n\n                // Main method\n                run: run\n            };\n        })();\n\n        return emojify;\n    }\n));\n","emojify.setConfig({img_dir : Config.cdnDomain + 'assets/images/emoji'});\n\nemojify.run();\n\n// 图片被点击后向通过 JavascriptBridge 向宿主应用发送图片 URL\nfunction connectWebViewJavascriptBridge(callback) {\n    if (window.WebViewJavascriptBridge) {\n        callback(WebViewJavascriptBridge)\n    } else {\n        document.addEventListener('WebViewJavascriptBridgeReady', function () {\n            callback(WebViewJavascriptBridge)\n        }, false)\n    }\n}\n\nconnectWebViewJavascriptBridge(function (bridge) {\n    bridge.init(function (message, responseCallback) {\n        responseCallback(data)\n    });\n\n    var imgs = document.querySelectorAll('.markdown-content img');\n\n    for (var i = 0; i < imgs.length; i++) {\n        imgs[i].onclick = function (e) {\n            var data = {\"imageUrl\": this.src};\n            bridge.send(data, function (responseData) {\n\n            })\n        }\n    }\n});"]}